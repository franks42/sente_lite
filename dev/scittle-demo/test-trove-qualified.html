<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Trove Direct Macros - Qualified Names</title>

  <!-- Load Scittle core -->
  <script src="https://cdn.jsdelivr.net/npm/scittle@0.7.28/dist/scittle.js"
          type="application/javascript"></script>

  <!-- Load Trove source files -->
  <script src="src/taoensso/trove/utils.cljc" type="application/x-scittle"></script>
  <script src="src/taoensso/trove/console.cljc" type="application/x-scittle"></script>
  <script src="src/taoensso/trove.cljc" type="application/x-scittle"></script>

  <style>
    body { font-family: monospace; margin: 20px; }
    h1 { color: #333; }
    .result { background: white; border: 1px solid #ddd; padding: 15px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>üß™ Trove Direct Macros - Qualified Names</h1>
  
  <div class="result">
    <h2>Test Results</h2>
    <div id="results"></div>
  </div>

  <script type="application/x-scittle">
    ;; Test using fully qualified names (no :refer)
    
    (println "\n=== Test 1: Require Trove namespace ===")
    (require '[taoensso.trove :as trove])
    (println "‚úÖ Successfully required taoensso.trove")
    
    (println "\n=== Test 2: Use trove/log! macro directly ===")
    (try
      (trove/log! {:level :info :id :test/direct :data {:message "Direct macro test"}})
      (println "‚úÖ Direct trove/log! macro call succeeded!")
      (catch :default e
        (println (str "‚ùå Failed: " e))))
    
    (println "\n=== Test 3: All log levels ===")
    (try
      (trove/log! {:level :trace :id :test/trace})
      (trove/log! {:level :debug :id :test/debug})
      (trove/log! {:level :info :id :test/info})
      (trove/log! {:level :warn :id :test/warn})
      (trove/log! {:level :error :id :test/error})
      (trove/log! {:level :fatal :id :test/fatal})
      (println "‚úÖ All log levels work!")
      (catch :default e
        (println (str "‚ùå Failed: " e))))
    
    (println "\n=== Test 4: Complex data ===")
    (try
      (trove/log! 
        {:level :info 
         :id :test/complex
         :data {:user {:id 123 :name "Test User"}
                :action "login"
                :timestamp (js/Date.now)}})
      (println "‚úÖ Complex data logging works!")
      (catch :default e
        (println (str "‚ùå Failed: " e))))
    
    (println "\n=== Test 5: Error logging ===")
    (try
      (try
        (throw (js/Error. "Test error"))
        (catch js/Error e
          (trove/log! 
            {:level :error 
             :id :test/error-logging
             :error e})))
      (println "‚úÖ Error logging works!")
      (catch :default e
        (println (str "‚ùå Failed: " e))))
    
    (println "\n=== Test 6: set-log-fn! macro ===")
    (try
      (trove/set-log-fn! (fn [& args] (println "Custom log fn called!")))
      (println "‚úÖ set-log-fn! works!")
      (catch :default e
        (println (str "‚ùå set-log-fn! failed: " e))))
    
    (println "\n" (apply str (repeat 60 "=")))
    (println "FINAL SUMMARY")
    (println (apply str (repeat 60 "=")))
    (println "\nüéâ SUCCESS! We can use Trove macros directly!")
    (println "‚úÖ No wrapper needed!")
    (println "‚úÖ Use fully qualified names (trove/log!)")
    (println "‚úÖ All log levels work")
    (println "‚úÖ Complex data works")
    (println "‚úÖ Error logging works")
    (println "‚úÖ set-log-fn! works")
  </script>
</body>
</html>

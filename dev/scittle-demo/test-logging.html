<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sente-lite Logging Test</title>

  <!-- Load Trove FIRST (before Scittle) -->
  <script src="https://cdn.jsdelivr.net/npm/com.taoensso/trove@1.1.0/dist/trove.umd.js"
          type="application/javascript"></script>

  <!-- Load Scittle core AFTER Trove -->
  <script src="https://cdn.jsdelivr.net/npm/scittle@0.7.28/dist/scittle.js"
          type="application/javascript"></script>

  <style>
    body {
      font-family: monospace;
      margin: 20px;
      background-color: #f5f5f5;
    }
    h1 {
      color: #333;
    }
    .log-container {
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 15px;
      margin-top: 20px;
      max-height: 400px;
      overflow-y: auto;
    }
    .log-entry {
      padding: 5px 0;
      border-bottom: 1px solid #eee;
      font-size: 12px;
    }
    .log-entry:last-child {
      border-bottom: none;
    }
    .trace { color: #999; }
    .debug { color: #0066cc; }
    .info { color: #009900; }
    .warn { color: #ff9900; }
    .error { color: #cc0000; }
    .fatal { color: #990000; font-weight: bold; }
  </style>
</head>
<body>
  <h1>üß™ Sente-lite Logging Test</h1>
  
  <div>
    <h2>Test Status</h2>
    <p id="status">Loading...</p>
  </div>

  <div class="log-container">
    <h2>Console Logs</h2>
    <div id="logs"></div>
  </div>

  <script type="application/x-scittle">
    ;; Test Trove logging
    (println "üß™ Testing Trove Logging...")
    
    ;; Check if Trove is available
    (let [trove-available? (not (nil? (aget js/window "taoensso")))]
      (if trove-available?
        (do
          (println "‚úÖ Trove is available!")
          ;; Get Trove from window
          (let [trove (aget js/window "taoensso" "trove")
                log-fn (aget trove "log")]
            
            ;; Test all log levels
            (log-fn #js {:level "trace" :id "test/trace-level" :data #js {:message "Trace level test"}})
            (log-fn #js {:level "debug" :id "test/debug-level" :data #js {:message "Debug level test"}})
            (log-fn #js {:level "info" :id "test/info-level" :data #js {:message "Info level test"}})
            (log-fn #js {:level "warn" :id "test/warn-level" :data #js {:message "Warn level test"}})
            (log-fn #js {:level "error" :id "test/error-level" :data #js {:message "Error level test"}})
            (log-fn #js {:level "fatal" :id "test/fatal-level" :data #js {:message "Fatal level test"}})

            ;; Test complex data
            (log-fn #js {:level "debug"
                         :id "test/complex-data"
                         :data #js {:user #js {:id 123 :name "Test User"}
                                    :nested #js {:level1 #js {:level2 "deep"}}
                                    :timestamp (js/Date.now)}})

            ;; Test error logging
            (try
              (throw (js/Error. "Test error"))
              (catch js/Error e
                (log-fn #js {:level "error"
                             :id "test/error-with-exception"
                             :data #js {:error e :message (.-message e)}})))

            ;; Update status
            (set! (.-innerHTML (js/document.getElementById "status"))
              "‚úÖ Trove logging tests completed! Check console logs below.")))
        (do
          (println "‚ùå Trove not available!")
          (set! (.-innerHTML (js/document.getElementById "status"))
            "‚ùå Trove not available in window object"))))

    (println "‚úÖ Test script completed!")
  </script>
</body>
</html>

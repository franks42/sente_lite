<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sente-lite Logging Test</title>

  <!-- Load Trove FIRST (before Scittle) -->
  <script src="https://cdn.jsdelivr.net/npm/com.taoensso/trove@1.1.0/dist/trove.umd.js"
          type="application/javascript"></script>

  <!-- Load Scittle core AFTER Trove -->
  <script src="https://cdn.jsdelivr.net/npm/scittle@0.7.28/dist/scittle.js"
          type="application/javascript"></script>

  <!-- Load Trove from local source (ClojureScript) -->
  <script src="../../src/taoensso/trove/utils.cljc" type="application/x-scittle"></script>
  <script src="../../src/taoensso/trove/console.cljc" type="application/x-scittle"></script>
  <script src="../../src/taoensso/trove.cljc" type="application/x-scittle"></script>

  <!-- Load sente-lite logging interface -->
  <script src="../../src/sente_lite/logging.cljc" type="application/x-scittle"></script>

  <style>
    body {
      font-family: monospace;
      margin: 20px;
      background-color: #f5f5f5;
    }
    h1 {
      color: #333;
    }
    .log-container {
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 15px;
      margin-top: 20px;
      max-height: 400px;
      overflow-y: auto;
    }
    .log-entry {
      padding: 5px 0;
      border-bottom: 1px solid #eee;
      font-size: 12px;
    }
    .log-entry:last-child {
      border-bottom: none;
    }
    .trace { color: #999; }
    .debug { color: #0066cc; }
    .info { color: #009900; }
    .warn { color: #ff9900; }
    .error { color: #cc0000; }
    .fatal { color: #990000; font-weight: bold; }
  </style>
</head>
<body>
  <h1>ðŸ§ª Sente-lite Logging Test</h1>
  
  <div>
    <h2>Test Status</h2>
    <p id="status">Loading...</p>
  </div>

  <div class="log-container">
    <h2>Console Logs</h2>
    <div id="logs"></div>
  </div>

  <script type="application/x-scittle">
    ;; Test Trove logging loaded from local source
    (require '[taoensso.trove :as trove])
    (require '[sente-lite.logging :as log])
    
    (println "ðŸ§ª Testing Trove Logging from local source...")
    
    ;; Test all log levels using sente-lite.logging
    (log/trace :test/trace-level {:message "Trace level test"})
    (log/debug :test/debug-level {:message "Debug level test"})
    (log/info :test/info-level {:message "Info level test"})
    (log/warn :test/warn-level {:message "Warn level test"})
    (log/error :test/error-level {:message "Error level test"})
    (log/fatal :test/fatal-level {:message "Fatal level test"})

    ;; Test complex data
    (log/debug :test/complex-data
      {:user {:id 123 :name "Test User"}
       :nested {:level1 {:level2 "deep"}}
       :timestamp (js/Date.now)})

    ;; Test error logging
    (try
      (throw (js/Error. "Test error"))
      (catch js/Error e
        (log/error :test/error-with-exception
          {:error e :message (.-message e)})))

    ;; Test direct Trove logging
    (trove/log! {:level :info :id :test/direct-trove :data {:message "Direct Trove test"}})

    ;; Update status
    (set! (.-innerHTML (js/document.getElementById "status"))
      "âœ… Trove logging tests completed! Check console logs below.")

    (println "âœ… All tests completed!")
  </script>
</body>
</html>
